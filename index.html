<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ARSENE'S KITCHEN</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-img">AK</div>
                    <div class="logo-text">ARSENE'S KITCHEN</div>
                </div>
                <div class="header-actions">
                    <span class="status-badge" id="statusBadge">BUKA</span>
                    <a href="#" class="admin-link" id="adminToggle">
                        <i class="fas fa-user-cog"></i>
                        <span>Kasir</span>
                    </a>
                    <button class="admin-link" id="themeToggle">
                        <i class="fas fa-moon"></i>
                        <span>Mode Gelap</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Closed Overlay -->
    <div class="closed-overlay" id="closedOverlay">
        <div class="closed-message">
            <h2><i class="fas fa-store-slash"></i> Toko Sedang Tutup</h2>
            <p>Maaf, ARSENE'S KITCHEN sedang tutup saat ini. Silakan kembali pada jam operasional kami.</p>
            <p>Jam Operasional: <span id="hoursDisplay">08:00 - 18:00</span></p>
            <div id="adminAccessBtn">
                <a href="#" class="admin-link" id="adminAccessButton">
                    <i class="fas fa-user-cog"></i>
                    <span>Akses Admin</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <h2><i class="fas fa-lock"></i> Login Kasir</h2>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Masukkan username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Masukkan password">
            </div>
            <button class="btn btn-primary" id="loginBtn">Login</button>
            <button class="btn btn-secondary" id="cancelLogin" style="margin-top: 10px;">Batal</button>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="container admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2>Panel Admin Kasir</h2>

            <!-- PRINTER CONTROLS -->
            <div class="printer-controls">
                <button id="connectPrinterBtn" class="btn btn-success"><i class="fas fa-plug"></i> Connect Printer</button>
                <button id="disconnectPrinterBtn" class="btn btn-danger" style="display:none;"><i class="fas fa-unlink"></i> Disconnect</button>
                <span id="printerStatus" class="printer-status">Tidak Terhubung</span>
                <button class="btn btn-secondary" id="closeAdmin">Kembali ke Mode Konsumen</button>
            </div>
        </div>

        <div class="admin-tabs">
            <div class="admin-tab active" data-tab="orders">Pesanan</div>
            <div class="admin-tab" data-tab="menu">Kelola Menu</div>
            <div class="admin-tab" data-tab="hours">Jam Operasional</div>
            <div class="admin-tab" data-tab="reports">Laporan</div>
            <div class="admin-tab" data-tab="realtime">Realtime</div>
        </div>

        <div class="admin-content active" id="ordersContent">
            <h3>Daftar Pesanan</h3>
            <div class="order-list" id="orderList">
                <!-- Orders will be displayed here -->
            </div>
        </div>

        <div class="admin-content" id="menuContent">
            <h3>Kelola Menu</h3>
            <div class="table-responsive">
                <table class="menu-table">
                    <thead>
                        <tr>
                            <th>Tersedia</th>
                            <th>Nama Menu</th>
                            <th>Gambar (URL)</th>
                            <th>Harga</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="menuTableBody"></tbody>
                </table>
            </div>

            <button class="btn btn-primary toggle-form-btn" id="toggleMenuForm">Tampilkan Form Tambah Menu</button>

            <div class="add-menu-form" id="addMenuForm" style="display: none;">
                <h4>Tambah Menu Baru</h4>
                <div class="form-row">
                    <input type="text" id="newMenuName" placeholder="Nama Menu">
                    <input type="text" id="newMenuImage" placeholder="URL Gambar Menu">
                    <input type="number" id="newMenuPrice" placeholder="Harga">
                </div>
                <button class="btn btn-primary" id="addMenuBtn">Tambah Menu</button>
            </div>
        </div>

        <div class="admin-content" id="hoursContent">
            <h3>Kelola Jam Operasional</h3>
            <div class="hours-config">
                <div class="hours-row">
                    <label for="openTime">Buka:</label>
                    <input type="time" id="openTime" value="08:00">
                    <label for="closeTime">Tutup:</label>
                    <input type="time" id="closeTime" value="18:00">
                </div>
                <button class="btn btn-primary" id="saveHoursBtn">Simpan Jam Operasional</button>
            </div>

            <h3>Status Toko</h3>
            <div class="hours-config">
                <p>Status saat ini: <strong id="currentStatus">Buka</strong></p>
                <button class="btn btn-danger" id="closeNowBtn">Tutup Sekarang</button>
                <button class="btn btn-success" id="openNowBtn">Buka Sekarang</button>
            </div>
        </div>

        <div class="admin-content" id="reportsContent">
            <h3>Laporan Pendapatan</h3>

            <div class="report-filters">
                <div class="form-row">
                    <input type="date" id="reportStartDate">
                    <input type="date" id="reportEndDate">
                    <button class="btn btn-primary" id="generateReportBtn">Generate Laporan</button>
                </div>
            </div>

            <div class="report-summary">
                <div class="report-card">
                    <h3>Total Pendapatan</h3>
                    <div class="value" id="totalRevenue">Rp 0</div>
                </div>
                <div class="report-card">
                    <h3>Jumlah Pesanan</h3>
                    <div class="value" id="totalOrders">0</div>
                </div>
                <div class="report-card">
                    <h3>Rata-rata Pesanan</h3>
                    <div class="value" id="averageOrder">Rp 0</div>
                </div>
            </div>

            <h4>Detail Pesanan</h4>
            <div class="order-list" id="reportOrderList"></div>
        </div>

        <div class="admin-content" id="realtimeContent">
            <h3>Panel Realtime MQTT</h3>
            <div class="mqtt-controls">
                <button id="connectMqttBtn" class="btn btn-success"><i class="fas fa-plug"></i> Connect MQTT</button>
                <button id="disconnectMqttBtn" class="btn btn-danger" style="display:none;"><i class="fas fa-unlink"></i> Disconnect</button>
                <span id="mqttStatus" class="printer-status">Tidak Terhubung</span>
            </div>

            <div class="mqtt-config">
                <h4>Konfigurasi MQTT</h4>
                <div class="form-row">
                    <input type="text" id="mqttTopic" placeholder="Topik MQTT" value="arsenes_kitchen/orders">
                    <input type="text" id="mqttBroker" placeholder="Broker URL" value="wss://broker.hivemq.com:8884/mqtt">
                </div>
                <button class="btn btn-primary" id="saveMqttConfig">Simpan Konfigurasi</button>
            </div>

            <h4>Log Pesanan Real-time</h4>
            <div class="mqtt-log" id="mqttLog">
                <div class="log-entry">Menunggu koneksi MQTT...</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container" id="mainContent">
        <div class="main-content">
            <!-- Cart Section -->
            <section class="cart-section">
                <h2><i class="fas fa-shopping-cart"></i> Keranjang Pesanan</h2>

                <div class="customer-info">
                    <h3>Data Pelanggan</h3>
                    <input type="text" id="customerName" placeholder="Nama Pelanggan">
                    <input type="tel" id="customerPhone" placeholder="Nomor Telepon">
                </div>

                <div class="cart-items" id="cartItems">
                    <div class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Keranjang belanja Anda kosong</p>
                    </div>
                </div>

                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span id="subtotal">Rp 0</span>
                    </div>
                    <div class="summary-row discount-row" id="discountRow" style="display: none;">
                        <span>Diskon Member</span>
                        <span id="discountAmount">-Rp 0</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total</span>
                        <span id="total">Rp 0</span>
                    </div>

                    <div class="member-section">
                        <button class="btn-member" id="memberBtn">
                            <i class="fas fa-crown"></i> Member
                        </button>
                    </div>

                    <button class="checkout-btn" id="checkoutBtn" disabled>Pesan Sekarang</button>
                </div>
            </section>

            <!-- Menu Section -->
            <section class="menu-section">
                <h2>Daftar Menu</h2>

                <!-- LIST layout (seluruh mode) -->
                <div class="menu-list" id="menuList">
                    <!-- Menu items will be displayed here -->
                </div>
            </section>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ARSENE'S KITCHEN</h3>
                    <p>Menyajikan masakan rumahan terbaik dengan cita rasa autentik</p>
                </div>
                <div class="footer-section">
                    <h3>Kontak Kami</h3>
                    <p><i class="fas fa-map-marker-alt"></i> Villa Karawangi, Blok J2 No.4 - Karawang</p>
                    <p><i class="fas fa-phone"></i> 0857 7538 6466</p>
                    <p><i class="fas fa-envelope"></i> arsenes_kitchen@gmail.com</p>
                </div>
                <div class="footer-section">
                    <h3>Jam Operasional</h3>
                    <p id="footerHours">Senin - Minggu: 08:00 - 18:00</p>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 ARSENE'S KITCHEN. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Notification -->
    <div class="notification" id="notification">Item telah ditambahkan ke keranjang!</div>

    <!-- Order Success Modal -->
    <div class="modal order-success-modal" id="orderSuccessModal">
        <div class="modal-content">
            <div class="success-icon"><i class="fas fa-check-circle"></i></div>
            <h2>Terima Kasih!</h2>
            <p>Pesanan <span id="successCustomerName">Nama Pelanggan</span> telah berhasil diterima.</p>
            <p>Total pesanan: <span id="successTotal">Rp 0</span></p>
            <button class="btn btn-primary" id="closeSuccessModal">Tutup</button>
        </div>
    </div>
    
    <!-- MQTT Connection Modal -->
<div class="modal" id="mqttModal">
    <div class="modal-content">
        <h2><i class="fas fa-wifi"></i> Status Koneksi MQTT</h2>
        <div class="connection-status">
            <div class="status-indicator" id="mqttStatusIndicator"></div>
            <span id="mqttStatusText">Menghubungkan...</span>
        </div>
        <div class="mqtt-details">
            <p><strong>Broker:</strong> <span id="mqttBrokerInfo">wss://broker.hivemq.com:8884/mqtt</span></p>
            <p><strong>Topik:</strong> <span id="mqttTopicInfo">arsenes_kitchen/orders</span></p>
        </div>
        
        <div class="form-row">
            <input type="text" id="serverPollUrl" placeholder="Server poll URL (optional, contoh: https://example.com/api/orders/latest)" value="">
            <input type="number" id="serverPollInterval" placeholder="Interval detik (default 5)" value="5" min="1" style="width:140px;">
        </div>
        <div class="form-row">
            <button class="btn btn-primary" id="startServerPollBtn">Start Poll Server</button>
            <button class="btn btn-secondary" id="stopServerPollBtn" style="display:none;">Stop Poll Server</button>
            <span id="serverPollStatus" style="margin-left:12px;color:var(--muted);">Idle</span>
        </div>
<div class="modal-actions">
            <button class="btn btn-primary" id="mqttReconnectBtn">Coba Hubungkan Kembali</button>
            <button class="btn btn-secondary" id="mqttCloseBtn">Tutup</button>
        </div>
    </div>
</div>

    <!-- MQTT Script -->
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
